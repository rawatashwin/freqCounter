MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00002 ; Author: Ashwin Rawat                                                         ;
                      00003 ; Program: Frequency Counter                                                   ;
                      00004 ; Repo: https://github.com/rawatashwin/freqCounter.git                         ;
                      00005 ; Device: pic12f675                                                            ;
                      00006 ; Description: High rising pulses are counted using timer1 for 62.5ms(timer0)  ;
                      00007 ; The number obtained is multiplied by 16 to get actual frequency.             ;
                      00008 ; Since pic12f675 has only 5 io pins, 74hc595 is used to interact with lcd     ;
                      00009 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00010     
                      00011 #include "p12f675.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Sep 19 2017
                      00005 ;  MPASM PIC12F675 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2017 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00367         LIST
                      00012 
                      00013 ; CONFIG
                      00014 ; __config 0xF1D4
2007   3FD4           00015  __CONFIG _FOSC_INTRCIO & _WDTE_OFF & _PWRTE_OFF & _MCLRE_OFF & _BOREN_ON & _CP_OFF & _CPD_OFF
                      00016 
                      00017 ; Input
                      00018 #define     freqInput   GPIO, 5
                      00019 
                      00020 ; Lcd using 74hc595
                      00021 #define     lcdData     GPIO, 0
                      00022 #define     lcdClk      GPIO, 1
                      00023 #define     lcdEn       GPIO, 2
                      00024  
                      00025     cblock          0x20
  00000020            00026         w_tmp
  00000021            00027         status_tmp
  00000022            00028         tmr1_counter
  00000023            00029         counting_flag
  00000024            00030         range_err_flag
                      00031         
                      00032         ; Pulses per 62.5 ms
  00000025            00033         freqBy16_2
  00000026            00034         freqBy16_1
  00000027            00035         freqBy16_0
                      00036         ; Frequency in binary
  00000028            00037         freqh3
  00000029            00038         freqh2
  0000002A            00039         freqh1
  0000002B            00040         freqh0
                      00041         ; Frequency in bcd
  0000002C            00042         freqd9
  0000002D            00043         freqd8
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000002E            00044         freqd7
  0000002F            00045         freqd6
  00000030            00046         freqd5
  00000031            00047         freqd4
  00000032            00048         freqd3
  00000033            00049         freqd2
  00000034            00050         freqd1
  00000035            00051         freqd0
  00000036            00052         bitcnt  
  00000037            00053         digcnt
                      00054         
                      00055         ; Lcd
  00000038            00056         lcd_data
  00000039            00057         lcd_tmp
                      00058         
                      00059         ;delay
  0000003A            00060         d1
  0000003B            00061         d2
                      00062     endc
                      00063 
                      00064 ; Bank Switching macros
                      00065 bank0   macro
                      00066         bcf STATUS, 5
                      00067         endm
                      00068         
                      00069 bank1   macro
                      00070         bsf STATUS, 5
                      00071         endm
                      00072         
                      00073 ; Reset Vector
0000                  00074     org     0x00
0000   2805           00075     goto    start
0004                  00076     org     0x04
0004   29B2           00077     goto    isr
                      00078     
                      00079 ; Start
0005                  00080 start:
0005   200C           00081     call    init
0006   2007           00082     call    repeat
                      00083 
                      00084 ; Loop
0007                  00085 repeat:
                      00086     ; Skip if still counting
0007   1C23           00087     btfss   counting_flag, 0
0008   2028           00088     call    startCounting
                      00089     ; FreqBy16 to Freqh
0009   2044           00090     call    getFreq
                      00091     ; Get Freq in BCD from Freqh
000A   2055           00092     call    freqToBCD
                      00093     ; Display on lcd
000B   2807           00094     goto    repeat
                      00095     
000C                  00096 init:
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00097     ; Setup GPIO
                      00098     ; ANSEL
                      00099     bank1
000C   1683               M         bsf STATUS, 5
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   019F           00100     clrf    ANSEL
                      00101     
                      00102     ; TRISIO
000E   302F           00103     movlw   b'00101111'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000F   0085           00104     movwf   TRISIO
                      00105     
                      00106     bank0
0010   1283               M         bcf STATUS, 5
                      00107     ; Setup timer1 as counter to count pulses on pin 2
0011   3036           00108     movlw   b'00110110' ; Async counter with 1/8 prescaler
0012   0090           00109     movwf   T1CON
                      00110     
                      00111     ; Setup timer0 
0013   3007           00112     movlw   b'00000111' ; Count system clock with prescler 256
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0014   0081           00113     movwf   OPTION_REG
                      00114     
                      00115     ; Reset counting flag
0015   1023           00116     bcf     counting_flag, 0
                      00117     
                      00118     ; Setup LCD
                      00119     ; Wait 40ms
0016   21C5           00120     call    wait_40ms
                      00121     ; Setup lcd in 4-bit mode
0017   3020           00122     movlw   0x20
0018   00B8           00123     movwf   lcd_data
0019   2074           00124     call    lcd_send_cmd
001A   21C0           00125     call    wait_1ms
                      00126     ; Set entry mode
001B   3006           00127     movlw   0x06
001C   00B8           00128     movwf   lcd_data
001D   2074           00129     call    lcd_send_cmd
001E   21C0           00130     call    wait_1ms
                      00131     ; Set return home
001F   3002           00132     movlw   0x02
0020   00B8           00133     movwf   lcd_data
0021   2074           00134     call    lcd_send_cmd
0022   21C0           00135     call    wait_1ms
                      00136     ; Turns on disp
0023   300D           00137     movlw   0x0d
0024   00B8           00138     movwf   lcd_data
0025   2074           00139     call    lcd_send_cmd
0026   21C0           00140     call    wait_1ms
                      00141     
0027   0008           00142     return
                      00143     
0028                  00144 startCounting:
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00145     ; Get number of pulses in 62.5ms and multiply by 16 (62.5ms * 16 = 1s) to get freq in Hz
                      00146     ; Setup Interrupts
                      00147     bank1
0028   1683               M         bsf STATUS, 5
                      00148     ; Timer1 Int enable
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0029   140C           00149     bsf     PIE1, 0 
                      00150     bank0
002A   1283               M         bcf STATUS, 5
                      00151     ; Clear tmr1_counter
002B   01A2           00152     clrf    tmr1_counter
                      00153     ; Set Counting Flag
002C   1423           00154     bsf     counting_flag, 0
                      00155     ; Peripheral Int enable
002D   170B           00156     bsf     INTCON, 6 
                      00157     ; Tmr0 Int enable
002E   168B           00158     bsf     INTCON, 5 
                      00159     ; Setup timer0 for 62.5ms
002F   300C           00160     movlw   0x0c   
0030   0081           00161     movwf   TMR0
                      00162     ; Start timer1
0031   1410           00163     bsf     T1CON, 0
                      00164     ; Enable Int
0032   178B           00165     bsf     INTCON, 7
0033   0008           00166     return
                      00167     
0034                  00168 stopCounting:
                      00169     ; Stop timer0 Int
0034   128B           00170     bcf     INTCON, 5
                      00171     ; Stop timer1
0035   1010           00172     bcf     T1CON, 0
                      00173     ; Reset T0IF
0036   110B           00174     bcf     INTCON, 2
                      00175     ; Reset TMR1IF
0037   100C           00176     bcf     PIR1, 0
                      00177     ; Reset counting flag
0038   1023           00178     bcf     counting_flag, 0
                      00179     ; Put TMR1 into freqBy16
0039   080E           00180     movf    TMR1L, w
003A   00A7           00181     movwf   freqBy16_0
003B   080F           00182     movf    TMR1H, w
003C   00A6           00183     movwf   freqBy16_1
Message[305]: Using default destination of 1 (file).
003D   08A2           00184     movf    tmr1_counter
003E   00A5           00185     movwf   freqBy16_2
003F   0008           00186     return
                      00187     
0040                  00188 incTmr1Cntr:
Message[305]: Using default destination of 1 (file).
0040   0FA2           00189     incfsz  tmr1_counter
0041   0008           00190     return
0042   1424           00191     bsf     range_err_flag, 0
0043   0008           00192     return
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00193     
                      00194 ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00195 ;   Frequency  conversion ;
                      00196 ;;;;;;;;;;;;;;;;;;;;;;;;;;; 
                      00197    
0044                  00198 getFreq:
0044   01AB           00199     clrf    freqh0
0045   01AA           00200     clrf    freqh1
0046   01A9           00201     clrf    freqh2
0047   01A8           00202     clrf    freqh3
                      00203     
                      00204     ; Multiply Freq by 2*2*2*2
0048   204D           00205     call    times2
0049   204D           00206     call    times2
004A   204D           00207     call    times2
004B   204D           00208     call    times2
004C   0008           00209     return    
004D                  00210 times2:
004D   0D27           00211     rlf     freqBy16_0, w
004E   00AB           00212     movwf   freqh0
004F   0D26           00213     rlf     freqBy16_1, w
0050   00AA           00214     movwf   freqh1
0051   0D25           00215     rlf     freqBy16_2, w
0052   00A9           00216     movwf   freqh2
Message[305]: Using default destination of 1 (file).
0053   0DA8           00217     rlf     freqh3
0054   0008           00218     return
                      00219         
                      00220 ; Convert freqh into bcd and store it in freqd
                      00221 ; Taken from http://www.piclist.com/techref/member/BB-LTL-/index.htm
0055                  00222 freqToBCD:
0055   01AC           00223     clrf    freqd9      ; Clear previous value
0056   01AD           00224     clrf    freqd8
0057   01AE           00225     clrf    freqd7
0058   01AF           00226     clrf    freqd6
0059   01B0           00227     clrf    freqd5
005A   01B1           00228     clrf    freqd4
005B   01B2           00229     clrf    freqd3
005C   01B3           00230     clrf    freqd2
005D   01B4           00231     clrf    freqd1
005E   01B5           00232     clrf    freqd0
                      00233     ; Outer loop bit counter
005F   3020           00234     movlw   D'32'       
0060   00B6           00235     movwf   bitcnt      
0061                  00236 b2bcd1:
                      00237     ; Shift 32bit bin acc left to put ms bit into carry
0061   0DAB           00238     rlf     freqh0, f   
0062   0DAA           00239     rlf     freqh1, f      
0063   0DA9           00240     rlf     freqh2, f      
0064   0DA8           00241     rlf     freqh3, f   
                      00242     ; Point to address of ls bcd digit
0065   3035           00243     movlw   freqd0      
0066   0084           00244     movwf   FSR         
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00245     ; Inner loop digit coutner
0067   300A           00246     movlw   D'10'
0068   00B7           00247     movwf   digcnt
0069                  00248 b2bcd2:
                      00249     ; Shift carry into bcd digit
0069   0D80           00250     rlf     INDF, f
                      00251     ; Substract 10 from digit then check and adjust for decimal overflow
006A   300A           00252     movlw   D'10'
006B   0200           00253     subwf   INDF, w
                      00254     ; If carry = 1 (result >= 0) adjust for decimal overflow
006C   1803           00255     btfsc   STATUS, C
006D   0080           00256     movwf   INDF
                      00257     ; Point to next BCD digit
006E   0384           00258     decf    FSR, f
                      00259     ; Decrement digcnt, loop if > 0
006F   0BB7           00260     decfsz  digcnt, f
0070   2869           00261     goto    b2bcd2
                      00262     ; Decrement bitcnt, loop if > 0
0071   0BB6           00263     decfsz  bitcnt, f
0072   2861           00264     goto    b2bcd1
0073   3400           00265     retlw   0   
                      00266 
                      00267     
                      00268 ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00269 ;   LCD Code              ;
                      00270 ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00271 ; LCD connected in 4 bit mode through 74hc595
                      00272 ; LCD DB7:DB4 connected to QA:QD
                      00273 ; LCD RS connected to QH
                      00274     
                      00275     ; Some macros to help with lcd
Warning[207]: Found label after column 1. (lcd_shift_out)
                      00276     lcd_shift_out       macro
                      00277     bcf     STATUS, C
                      00278     rrf     lcd_tmp
                      00279     btfsc   STATUS, C
                      00280     bsf     lcdData
                      00281     btfss   STATUS, C
                      00282     bcf     lcdData
                      00283     bsf     lcdClk
                      00284     nop
                      00285     bcf     lcdClk     
                      00286     nop
                      00287     endm
                      00288     
Warning[207]: Found label after column 1. (lcd_send_0)
                      00289     lcd_send_0  macro
                      00290     bcf     lcdData
                      00291     bsf     lcdClk
                      00292     nop
                      00293     bcf     lcdClk
                      00294     nop
                      00295     endm
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00296     
Warning[207]: Found label after column 1. (lcd_send_1)
                      00297     lcd_send_1  macro
                      00298     bsf     lcdData
                      00299     bsf     lcdClk
                      00300     nop
                      00301     bcf     lcdClk   
                      00302     nop
                      00303     endm    
                      00304     
Warning[207]: Found label after column 1. (lcd_send_EN)
                      00305     lcd_send_EN macro
                      00306     nop
                      00307     nop
                      00308     nop
                      00309     nop
                      00310     nop
                      00311     bsf     lcdEn
                      00312     nop
                      00313     nop
                      00314     nop
                      00315     nop
                      00316     nop
                      00317     nop
                      00318     bcf     lcdEn
                      00319     nop
                      00320     nop
                      00321     nop
                      00322     nop
                      00323     nop
                      00324     endm
                      00325     
0074                  00326 lcd_send_cmd:   ; Sends word in lcd_data to lcd
                      00327     ; Send higher nibble
0074   0E38           00328     swapf   lcd_data, w
0075   00B9           00329     movwf   lcd_tmp
                      00330     ; Shift out 4 (higher) bits
                      00331     lcd_shift_out
0076   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0077   0CB9               M     rrf     lcd_tmp
0078   1803               M     btfsc   STATUS, C
0079   1405               M     bsf     lcdData
007A   1C03               M     btfss   STATUS, C
007B   1005               M     bcf     lcdData
007C   1485               M     bsf     lcdClk
007D   0000               M     nop
007E   1085               M     bcf     lcdClk     
007F   0000               M     nop
                      00332     lcd_shift_out
0080   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0081   0CB9               M     rrf     lcd_tmp
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0082   1803               M     btfsc   STATUS, C
0083   1405               M     bsf     lcdData
0084   1C03               M     btfss   STATUS, C
0085   1005               M     bcf     lcdData
0086   1485               M     bsf     lcdClk
0087   0000               M     nop
0088   1085               M     bcf     lcdClk     
0089   0000               M     nop
                      00333     lcd_shift_out
008A   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
008B   0CB9               M     rrf     lcd_tmp
008C   1803               M     btfsc   STATUS, C
008D   1405               M     bsf     lcdData
008E   1C03               M     btfss   STATUS, C
008F   1005               M     bcf     lcdData
0090   1485               M     bsf     lcdClk
0091   0000               M     nop
0092   1085               M     bcf     lcdClk     
0093   0000               M     nop
                      00334     lcd_shift_out
0094   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0095   0CB9               M     rrf     lcd_tmp
0096   1803               M     btfsc   STATUS, C
0097   1405               M     bsf     lcdData
0098   1C03               M     btfss   STATUS, C
0099   1005               M     bcf     lcdData
009A   1485               M     bsf     lcdClk
009B   0000               M     nop
009C   1085               M     bcf     lcdClk     
009D   0000               M     nop
                      00335     ; Send 3 0s
                      00336     lcd_send_0
009E   1005               M     bcf     lcdData
009F   1485               M     bsf     lcdClk
00A0   0000               M     nop
00A1   1085               M     bcf     lcdClk
00A2   0000               M     nop
                      00337     lcd_send_0
00A3   1005               M     bcf     lcdData
00A4   1485               M     bsf     lcdClk
00A5   0000               M     nop
00A6   1085               M     bcf     lcdClk
00A7   0000               M     nop
                      00338     lcd_send_0
00A8   1005               M     bcf     lcdData
00A9   1485               M     bsf     lcdClk
00AA   0000               M     nop
00AB   1085               M     bcf     lcdClk
00AC   0000               M     nop
                      00339     ; Send 0 for selecting lcd command register
                      00340     lcd_send_0
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00AD   1005               M     bcf     lcdData
00AE   1485               M     bsf     lcdClk
00AF   0000               M     nop
00B0   1085               M     bcf     lcdClk
00B1   0000               M     nop
                      00341     ; Send EN
                      00342     lcd_send_EN    
00B2   0000               M     nop
00B3   0000               M     nop
00B4   0000               M     nop
00B5   0000               M     nop
00B6   0000               M     nop
00B7   1505               M     bsf     lcdEn
00B8   0000               M     nop
00B9   0000               M     nop
00BA   0000               M     nop
00BB   0000               M     nop
00BC   0000               M     nop
00BD   0000               M     nop
00BE   1105               M     bcf     lcdEn
00BF   0000               M     nop
00C0   0000               M     nop
00C1   0000               M     nop
00C2   0000               M     nop
00C3   0000               M     nop
                      00343     ; Shift out remaining bits (lower)
                      00344     lcd_shift_out
00C4   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
00C5   0CB9               M     rrf     lcd_tmp
00C6   1803               M     btfsc   STATUS, C
00C7   1405               M     bsf     lcdData
00C8   1C03               M     btfss   STATUS, C
00C9   1005               M     bcf     lcdData
00CA   1485               M     bsf     lcdClk
00CB   0000               M     nop
00CC   1085               M     bcf     lcdClk     
00CD   0000               M     nop
                      00345     lcd_shift_out
00CE   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
00CF   0CB9               M     rrf     lcd_tmp
00D0   1803               M     btfsc   STATUS, C
00D1   1405               M     bsf     lcdData
00D2   1C03               M     btfss   STATUS, C
00D3   1005               M     bcf     lcdData
00D4   1485               M     bsf     lcdClk
00D5   0000               M     nop
00D6   1085               M     bcf     lcdClk     
00D7   0000               M     nop
                      00346     lcd_shift_out
00D8   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D9   0CB9               M     rrf     lcd_tmp
00DA   1803               M     btfsc   STATUS, C
00DB   1405               M     bsf     lcdData
00DC   1C03               M     btfss   STATUS, C
00DD   1005               M     bcf     lcdData
00DE   1485               M     bsf     lcdClk
00DF   0000               M     nop
00E0   1085               M     bcf     lcdClk     
00E1   0000               M     nop
                      00347     lcd_shift_out
00E2   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
00E3   0CB9               M     rrf     lcd_tmp
00E4   1803               M     btfsc   STATUS, C
00E5   1405               M     bsf     lcdData
00E6   1C03               M     btfss   STATUS, C
00E7   1005               M     bcf     lcdData
00E8   1485               M     bsf     lcdClk
00E9   0000               M     nop
00EA   1085               M     bcf     lcdClk     
00EB   0000               M     nop
                      00348     ; Send 3 0s
                      00349     lcd_send_0
00EC   1005               M     bcf     lcdData
00ED   1485               M     bsf     lcdClk
00EE   0000               M     nop
00EF   1085               M     bcf     lcdClk
00F0   0000               M     nop
                      00350     lcd_send_0
00F1   1005               M     bcf     lcdData
00F2   1485               M     bsf     lcdClk
00F3   0000               M     nop
00F4   1085               M     bcf     lcdClk
00F5   0000               M     nop
                      00351     lcd_send_0
00F6   1005               M     bcf     lcdData
00F7   1485               M     bsf     lcdClk
00F8   0000               M     nop
00F9   1085               M     bcf     lcdClk
00FA   0000               M     nop
                      00352     ; Send 0 for selecting lcd command register
                      00353     lcd_send_0
00FB   1005               M     bcf     lcdData
00FC   1485               M     bsf     lcdClk
00FD   0000               M     nop
00FE   1085               M     bcf     lcdClk
00FF   0000               M     nop
                      00354     lcd_send_EN      
0100   0000               M     nop
0101   0000               M     nop
0102   0000               M     nop
0103   0000               M     nop
0104   0000               M     nop
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0105   1505               M     bsf     lcdEn
0106   0000               M     nop
0107   0000               M     nop
0108   0000               M     nop
0109   0000               M     nop
010A   0000               M     nop
010B   0000               M     nop
010C   1105               M     bcf     lcdEn
010D   0000               M     nop
010E   0000               M     nop
010F   0000               M     nop
0110   0000               M     nop
0111   0000               M     nop
0112   0008           00355     return
                      00356     
0113                  00357 lcd_send_data:  ; Sends word in lcd_data to lcd
                      00358     ; Send higher nibble
0113   0E38           00359     swapf   lcd_data, w
0114   00B9           00360     movwf   lcd_tmp
                      00361     ; Shift out 4 (higher) bits
                      00362     lcd_shift_out
0115   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0116   0CB9               M     rrf     lcd_tmp
0117   1803               M     btfsc   STATUS, C
0118   1405               M     bsf     lcdData
0119   1C03               M     btfss   STATUS, C
011A   1005               M     bcf     lcdData
011B   1485               M     bsf     lcdClk
011C   0000               M     nop
011D   1085               M     bcf     lcdClk     
011E   0000               M     nop
                      00363     lcd_shift_out
011F   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0120   0CB9               M     rrf     lcd_tmp
0121   1803               M     btfsc   STATUS, C
0122   1405               M     bsf     lcdData
0123   1C03               M     btfss   STATUS, C
0124   1005               M     bcf     lcdData
0125   1485               M     bsf     lcdClk
0126   0000               M     nop
0127   1085               M     bcf     lcdClk     
0128   0000               M     nop
                      00364     lcd_shift_out
0129   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
012A   0CB9               M     rrf     lcd_tmp
012B   1803               M     btfsc   STATUS, C
012C   1405               M     bsf     lcdData
012D   1C03               M     btfss   STATUS, C
012E   1005               M     bcf     lcdData
012F   1485               M     bsf     lcdClk
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0130   0000               M     nop
0131   1085               M     bcf     lcdClk     
0132   0000               M     nop
                      00365     lcd_shift_out
0133   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0134   0CB9               M     rrf     lcd_tmp
0135   1803               M     btfsc   STATUS, C
0136   1405               M     bsf     lcdData
0137   1C03               M     btfss   STATUS, C
0138   1005               M     bcf     lcdData
0139   1485               M     bsf     lcdClk
013A   0000               M     nop
013B   1085               M     bcf     lcdClk     
013C   0000               M     nop
                      00366     ; Send 3 0s
                      00367     lcd_send_0
013D   1005               M     bcf     lcdData
013E   1485               M     bsf     lcdClk
013F   0000               M     nop
0140   1085               M     bcf     lcdClk
0141   0000               M     nop
                      00368     lcd_send_0
0142   1005               M     bcf     lcdData
0143   1485               M     bsf     lcdClk
0144   0000               M     nop
0145   1085               M     bcf     lcdClk
0146   0000               M     nop
                      00369     lcd_send_0
0147   1005               M     bcf     lcdData
0148   1485               M     bsf     lcdClk
0149   0000               M     nop
014A   1085               M     bcf     lcdClk
014B   0000               M     nop
                      00370     ; Send 0 for selecting lcd data register
                      00371     lcd_send_1
014C   1405               M     bsf     lcdData
014D   1485               M     bsf     lcdClk
014E   0000               M     nop
014F   1085               M     bcf     lcdClk   
0150   0000               M     nop
                      00372     ; Send EN
                      00373     lcd_send_EN    
0151   0000               M     nop
0152   0000               M     nop
0153   0000               M     nop
0154   0000               M     nop
0155   0000               M     nop
0156   1505               M     bsf     lcdEn
0157   0000               M     nop
0158   0000               M     nop
0159   0000               M     nop
015A   0000               M     nop
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

015B   0000               M     nop
015C   0000               M     nop
015D   1105               M     bcf     lcdEn
015E   0000               M     nop
015F   0000               M     nop
0160   0000               M     nop
0161   0000               M     nop
0162   0000               M     nop
                      00374     ; Shift out remaining bits (lower)
                      00375     lcd_shift_out
0163   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0164   0CB9               M     rrf     lcd_tmp
0165   1803               M     btfsc   STATUS, C
0166   1405               M     bsf     lcdData
0167   1C03               M     btfss   STATUS, C
0168   1005               M     bcf     lcdData
0169   1485               M     bsf     lcdClk
016A   0000               M     nop
016B   1085               M     bcf     lcdClk     
016C   0000               M     nop
                      00376     lcd_shift_out
016D   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
016E   0CB9               M     rrf     lcd_tmp
016F   1803               M     btfsc   STATUS, C
0170   1405               M     bsf     lcdData
0171   1C03               M     btfss   STATUS, C
0172   1005               M     bcf     lcdData
0173   1485               M     bsf     lcdClk
0174   0000               M     nop
0175   1085               M     bcf     lcdClk     
0176   0000               M     nop
                      00377     lcd_shift_out
0177   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0178   0CB9               M     rrf     lcd_tmp
0179   1803               M     btfsc   STATUS, C
017A   1405               M     bsf     lcdData
017B   1C03               M     btfss   STATUS, C
017C   1005               M     bcf     lcdData
017D   1485               M     bsf     lcdClk
017E   0000               M     nop
017F   1085               M     bcf     lcdClk     
0180   0000               M     nop
                      00378     lcd_shift_out
0181   1003               M     bcf     STATUS, C
Message[305]: Using default destination of 1 (file).
0182   0CB9               M     rrf     lcd_tmp
0183   1803               M     btfsc   STATUS, C
0184   1405               M     bsf     lcdData
0185   1C03               M     btfss   STATUS, C
0186   1005               M     bcf     lcdData
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0187   1485               M     bsf     lcdClk
0188   0000               M     nop
0189   1085               M     bcf     lcdClk     
018A   0000               M     nop
                      00379     ; Send 3 0s
                      00380     lcd_send_0
018B   1005               M     bcf     lcdData
018C   1485               M     bsf     lcdClk
018D   0000               M     nop
018E   1085               M     bcf     lcdClk
018F   0000               M     nop
                      00381     lcd_send_0
0190   1005               M     bcf     lcdData
0191   1485               M     bsf     lcdClk
0192   0000               M     nop
0193   1085               M     bcf     lcdClk
0194   0000               M     nop
                      00382     lcd_send_0
0195   1005               M     bcf     lcdData
0196   1485               M     bsf     lcdClk
0197   0000               M     nop
0198   1085               M     bcf     lcdClk
0199   0000               M     nop
                      00383     ; Send 0 for selecting lcd data register
                      00384     lcd_send_1
019A   1405               M     bsf     lcdData
019B   1485               M     bsf     lcdClk
019C   0000               M     nop
019D   1085               M     bcf     lcdClk   
019E   0000               M     nop
                      00385     lcd_send_EN  
019F   0000               M     nop
01A0   0000               M     nop
01A1   0000               M     nop
01A2   0000               M     nop
01A3   0000               M     nop
01A4   1505               M     bsf     lcdEn
01A5   0000               M     nop
01A6   0000               M     nop
01A7   0000               M     nop
01A8   0000               M     nop
01A9   0000               M     nop
01AA   0000               M     nop
01AB   1105               M     bcf     lcdEn
01AC   0000               M     nop
01AD   0000               M     nop
01AE   0000               M     nop
01AF   0000               M     nop
01B0   0000               M     nop
01B1   0008           00386     return    
                      00387     
                      00388 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00389 ; Interrupt Service Routine;    
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00390 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;   
01B2                  00391 isr:
                      00392     bank0
01B2   1283               M         bcf STATUS, 5
                      00393     ; Disable Int
01B3   138B           00394     bcf     INTCON, 7 
                      00395     ; Context Save    
01B4   00A0           00396     movwf   w_tmp
01B5   0E03           00397     swapf   STATUS, w
01B6   00A1           00398     movwf   status_tmp
                      00399     ; end Context Save
                      00400     
                      00401     ; ISR
                      00402     ; Check if tmr0 overflowed
01B7   190B           00403     btfsc   INTCON, 2
01B8   2034           00404     call    stopCounting
                      00405     ; Check if tmr1 overflowed
01B9   180C           00406     btfsc   PIR1, 0
01BA   2040           00407     call    incTmr1Cntr
                      00408     
                      00409     ; Context Retrive
01BB   0E21           00410     swapf   status_tmp, w
01BC   0083           00411     movwf   STATUS
01BD   0EA0           00412     swapf   w_tmp, f
01BE   0E20           00413     swapf   w_tmp, w
                      00414     ; Return    
01BF   0009           00415     retfie
                      00416     
                      00417 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00418 ; Delay Subroutines        ;    
                      00419 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00420     
01C0                  00421 wait_1ms:
                      00422     ; Assuming 1 nop takes 200ns at 1Mhz Instruction cycle
01C0   0000           00423     nop
01C1   0000           00424     nop
01C2   0000           00425     nop
01C3   0000           00426     nop
01C4   0008           00427     return    
                      00428         
                      00429 ; Delay = 0.04 seconds
                      00430 ; Clock frequency = 1 MHz
                      00431 
                      00432 ; Actual delay = 0.04 seconds = 10000 cycles
                      00433 ; Error = 0 %
                      00434 
01C5                  00435 wait_40ms:
                      00436                         ;9993 cycles
01C5   30CE           00437         movlw   0xCE
01C6   00BA           00438         movwf   d1
01C7   3008           00439         movlw   0x08
01C8   00BB           00440         movwf   d2
01C9                  00441 Delay_0:
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01C9   0BBA           00442         decfsz  d1, f
01CA   29CC           00443         goto    $+2
01CB   0BBB           00444         decfsz  d2, f
01CC   29C9           00445         goto    Delay_0
                      00446 
                      00447                         ;3 cycles
01CD   29CE           00448         goto    $+1
01CE   0000           00449         nop
                      00450 
                      00451                         ;4 cycles (including call)
01CF   0008           00452         return
                      00453 ; Generated by http://www.piclist.com/cgi-bin/delay.exe (December 7, 2005 version)
                      00454 ; Thu Jan 18 11:00:50 2018 GMT
                      00455 ; See also various delay routines at http://www.piclist.com/techref/microchip/delays.htm
                      00456     
                      00457     end
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

ADCON0                            0000001F
ADCS0                             00000004
ADCS1                             00000005
ADCS2                             00000006
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
ANS0                              00000000
ANS1                              00000001
ANS2                              00000002
ANS3                              00000003
ANSEL                             0000009F
C                                 00000000
CAL0                              00000002
CAL1                              00000003
CAL2                              00000004
CAL3                              00000005
CAL4                              00000006
CAL5                              00000007
CHS0                              00000002
CHS1                              00000003
CINV                              00000004
CIS                               00000003
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             00000019
CMIE                              00000003
CMIF                              00000003
COUT                              00000006
DC                                00000001
Delay_0                           000001C9
EEADR                             0000009B
EECON1                            0000009C
EECON2                            0000009D
EEDAT                             0000009A
EEDATA                            0000009A
EEIE                              00000007
EEIF                              00000007
F                                 00000001
FSR                               00000004
GIE                               00000007
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
GP0                               00000000
GP1                               00000001
GP2                               00000002
GP3                               00000003
GP4                               00000004
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 18


SYMBOL TABLE
  LABEL                             VALUE 

GP5                               00000005
GPIE                              00000003
GPIF                              00000000
GPIO                              00000005
GPIO0                             00000000
GPIO1                             00000001
GPIO2                             00000002
GPIO3                             00000003
GPIO4                             00000004
GPIO5                             00000005
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IOC                               00000096
IOC0                              00000000
IOC1                              00000001
IOC2                              00000002
IOC3                              00000003
IOC4                              00000004
IOC5                              00000005
IOCB                              00000096
IOCB0                             00000000
IOCB1                             00000001
IOCB2                             00000002
IOCB3                             00000003
IOCB4                             00000004
IOCB5                             00000005
IRP                               00000007
NOT_BOD                           00000000
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_GPPU                          00000007
NOT_PD                            00000003
NOT_POR                           00000001
NOT_T1SYNC                        00000002
NOT_TO                            00000004
OPTION_REG                        00000081
OSCCAL                            00000090
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PIE1                              0000008C
PIR1                              0000000C
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
RD                                00000000
RP0                               00000005
RP1                               00000006
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 19


SYMBOL TABLE
  LABEL                             VALUE 

STATUS                            00000003
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1IE                              00000000
T1IF                              00000000
T1OSCEN                           00000003
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1GE                            00000006
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TRISIO                            00000085
TRISIO0                           00000000
TRISIO1                           00000001
TRISIO2                           00000002
TRISIO3                           00000003
TRISIO4                           00000004
TRISIO5                           00000005
VCFG                              00000006
VR0                               00000000
VR1                               00000001
VR2                               00000002
VR3                               00000003
VRCON                             00000099
VREN                              00000007
VRR                               00000005
W                                 00000000
WPU                               00000095
WPU0                              00000000
WPU1                              00000001
WPU2                              00000002
WPU4                              00000004
WPU5                              00000005
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 20


SYMBOL TABLE
  LABEL                             VALUE 

_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_OFF                           00003FFF
_CP_ON                            00003F7F
_DEVID1                           00002006
_EC_OSC                           00003FFB
_EXTRC_OSC_CLKOUT                 00003FFF
_EXTRC_OSC_NOCLKOUT               00003FFE
_FOSC_EC                          00003FFB
_FOSC_EXTRCCLK                    00003FFF
_FOSC_EXTRCIO                     00003FFE
_FOSC_HS                          00003FFA
_FOSC_INTRCCLK                    00003FFD
_FOSC_INTRCIO                     00003FFC
_FOSC_LP                          00003FF8
_FOSC_XT                          00003FF9
_HS_OSC                           00003FFA
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_INTRC_OSC_CLKOUT                 00003FFD
_INTRC_OSC_NOCLKOUT               00003FFC
_LP_OSC                           00003FF8
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FEF
_WDTE_OFF                         00003FF7
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FF7
_WDT_ON                           00003FFF
_XT_OSC                           00003FF9
__12F675                          00000001
b2bcd1                            00000061
b2bcd2                            00000069
bank0                             
bank1                             
bitcnt                            00000036
counting_flag                     00000023
d1                                0000003A
d2                                0000003B
digcnt                            00000037
freqBy16_0                        00000027
freqBy16_1                        00000026
freqBy16_2                        00000025
freqInput                         GPIO, 5
freqToBCD                         00000055
freqd0                            00000035
freqd1                            00000034
freqd2                            00000033
freqd3                            00000032
freqd4                            00000031
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

freqd5                            00000030
freqd6                            0000002F
freqd7                            0000002E
freqd8                            0000002D
freqd9                            0000002C
freqh0                            0000002B
freqh1                            0000002A
freqh2                            00000029
freqh3                            00000028
getFreq                           00000044
incTmr1Cntr                       00000040
init                              0000000C
isr                               000001B2
lcdClk                            GPIO, 1
lcdData                           GPIO, 0
lcdEn                             GPIO, 2
lcd_data                          00000038
lcd_send_0                        
lcd_send_1                        
lcd_send_EN                       
lcd_send_cmd                      00000074
lcd_send_data                     00000113
lcd_shift_out                     
lcd_tmp                           00000039
range_err_flag                    00000024
repeat                            00000007
start                             00000005
startCounting                     00000028
status_tmp                        00000021
stopCounting                      00000034
times2                            0000004D
tmr1_counter                      00000022
w_tmp                             00000020
wait_1ms                          000001C0
wait_40ms                         000001C5


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : X---XXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM 5.76                   FREQCOUNTER.ASM   1-18-2018  17:14:57         PAGE 22


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


01C0 : XXXXXXXXXXXXXXXX ---------------- ---------------- ----------------
2000 : -------X-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:   461
Program Memory Words Free:   563


Errors   :     0
Warnings :     4 reported,     0 suppressed
Messages :    23 reported,     0 suppressed

